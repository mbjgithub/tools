var expect = require('expect.js');
var uaAnalyser = require('..');
function defineUA(ua) {
	(function() {
		this.navigator = {userAgent: ua};
	})()
}

var $ = {};
function itFactory(browser, os, bversion, ua) {
	return function() {
		defineUA(ua);
		uaAnalyser.__clearCache();
		uaAnalyser.__jquery($ = {});
		expect($.browser.name).to.be(browser);
		expect($.browser[browser]).to.be(true);
		expect($.os[os]).to.be(true);
		expect($.os.name).to.be(os);
		expect($.browser.version).to.be(bversion);
	}
}
describe('ua test', function() {
	it('LG G3 WeChat', itFactory('WeChat', 'android', '6.2',
			`Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; LG-D728 Build/KOT49I.D72810b)
			AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025438 Mobile Safari/533.1
			MicroMessenger/6.2.2.54_rec1912d.581 NetType/WIFI Language/zh_CN`)
	);
	it('LG G3 QQClient', itFactory('MQQClient', 'android', '5.8',
			`Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; LG-D728 Build/KOT49I.D72810b)
			AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/8.8 TBS/88888888 Mobile Safari/533.1
			V1_AND_SQ_5.8.0_264_YYB_D QQ/5.8.0.2505 NetType/WIFI WebP/0.3.0`)
	);
	it('LG G3 QQBrowser', itFactory('MQQBrowser', 'android', '6.1',
			`Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; LG-D728 Build/KOT49I.D72810b)
			AppleWebKit/537.36 (KHTML, like Gecko)Version/4.0 MQQBrowser/6.1 Mobile Safari/537.36`)
	);
	it('LG G3 Chrome', itFactory('Chrome', 'android', '45.0',
			`Mozilla/5.0 (Linux; Android 4.4.2; LG-D728 Build/KOT49I.D72810b)
			AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.94 Mobile Safari/537.36`)
	);
	it('HuaWei qqnews', itFactory('qqnews', 'android', '4.9.2',
			`Mozilla/5.0 (Linux; Android 5.0.2; PLK-UL00 Build/HONORPLK-UL00)
			AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/37.0.0.0 Mobile Safari/537.36
			qqnews/4.9.2 qqnews/4.9.2 qqnews/4.9.2`)
	);
	it('Nexus TBSSDK', itFactory('TBSSDK', 'android', '2.15',
			`Mozilla/5.0 (Linux; Android 6.0.1; Nexus 6 Build/MMB29K) AppleWebKit/537.36 
			(KHTML, like Gecko) Version/4.0 Chrome/37.0.0.0 Mobile MQQBrowser/6.2 TBS/036555 
			Safari/537.36 MSDK/2.15.1a`)
	);
	it('qqlivebroadcast', itFactory('QQLiveBroadcast', 'android', undefined,
			`Mozilla/5.0 (Linux; Android 6.0.1; X900+ Build/CEXCNFN5801810191S; wv) 
			AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/49.0.2623.91 Mobile 
			Safari/537.362.0.0 qqlivebroadcast4Android`
	));

	it('iphone6 WeChat', itFactory('WeChat', 'iphone', '6.2',
			`Mozilla/5.0 (iPhone; CPU iPhone OS 9_0_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
			Mobile/13A404 MicroMessenger/6.2.7 NetType/WIFI Language/en`)
	);
	it('iphone6 QQClient', itFactory('MQQClient', 'iphone', '5.9',
			`Mozilla/5.0 (iPhone; CPU iPhone OS 9_0_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
			Mobile/13A404 QQ/5.9.0.432 Pixel/750 NetType/WIFI Mem/56`)
	);
	it('iphone6 QQBrowser', itFactory('MQQBrowser', 'iphone', '6.1',
			`Mozilla/5.0 (iPhone 6; CPU iPhone OS 9_0_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
			Version/6.0 MQQBrowser/6.1.1 Mobile/13A404 Safari/8536.25`)
	);
	it('iphone6 Chrome', itFactory('Chrome', 'iphone', '45.0',
			`Mozilla/5.0 (iPhone; CPU iPhone OS 9_0_1 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko)
			CriOS/45.0.2454.89 Mobile/13A404 Safari/600.1.4 (000735)`)
	);
	it('iphone6 Qzone', itFactory('Qzone', 'iphone', '5.8',
			`QZONEJSSDK/5.8.1.1 QQJSSDK/1.2 Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X)AppleWebKit/601.1.46
			 (KHTML, like Gecko) Mobile/13B143 Qzone/V1_IPH_QZ_5.8.1_1_APP_A NewVersion`)
	);
	it('iphone6 Safari', itFactory('Safari', 'iphone', '601.1',
			`Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
			Version/9.0 Mobile/13B143 Safari/601.1`)
	);
	it('iphone6 UcBrowser', itFactory('UCBrowser', 'iphone', '10.7',
			`Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko)
			Mobile/13B143 UCBrowser/10.7.11.672 Mobile`)
		
	);
	it('iphone6 weibo', itFactory('Weibo', 'iphone', undefined,
		`Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
			Mobile/13B143 Weibo (iPhone7,2__weibo__5.6.0__iphone__os9.1)`)
	);
	it('iphone6 douban', itFactory('douban', 'iphone', '3.4.0',
		`Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
		    Mobile/13D15 com.douban.frodo/3.4.0 Rexxar/1.0.2`)
	);
	it('iphone6 kuaibao', itFactory('kuaibao', 'iphone', '1.8.0',
		`Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko)
		    Mobile/13D15 qnreading/1.8.0 qnwebview`)
	)
});