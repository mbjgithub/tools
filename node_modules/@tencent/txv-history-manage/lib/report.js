var consts = require('./consts')
var fns = require('@tencent/fns')
var jsonp = require('@tencent/jsonp')

var URL = consts.api.myviewreport


module.exports = {
  reportOne: reportOne,
  batchReport: batchReport
}


function reportOne(data, cb) {
  data = fns.extend(data, {
    plat: 2,
    pver: 3, //cgi第3个版本,
    rf: 'v', //v:v.qq.com.hlw :film.qq.com
    t: consts.rParamT.ONEREPORT
  })

  jsonp(URL, data, function (err, res) {
    err ? cb('上报失败') : cb(null, res)
  })
}

function batchReport(data, cb) {
  data = fns.extend({
    pn: 1,
    list: '', //split by "|"
    rf: 'v'
  }, data, {
      t: consts.rParamT.BATCHREPORT,
      cur: 1,   //当前页码
      simp: 1,
      plat: 2, // 平台参数
      pver: 3  //第3个版本
    })
  jsonp(URL, data, function (err, res) {
    err ? cb('上报失败') : cb(null, res)
  })
}