!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function r(){}function i(){if("wx"===b.get("main_login")){var t=b.get("vuserid");return t&&t.length>0?parseInt(t,10):0}var e=b.get("skey")||"",n=b.get("lskey")||"";if(e=e.replace(/^\s*|\s*$/g,""),n=n.replace(/^\s*|\s*$/g,""),!e&&!n)return 0;var r=parseInt(b.get("uin").replace(/^o0*/g,""),10);return(!r||r<=1e4)&&(!(r=parseInt(b.get("luin").replace(/^o0*/g,""),10))||r<=1e4)?0:r}function o(){var t=i();return t?S+t:S}function u(t,e){return t=t||"",e=e||"",t+R+e}function a(t,e){var n=[];return t=t.split(I),x.forEach(t,function(t){~t.indexOf(e)&&(t=t.split(N),n.push(new k(t)))}),n}function c(t,e){var n,r,i=u(t,e),c=o(),f=$.get(c)||"";return f?(r=a(f,i),n=i.length>2?r[0]||{}:y(r)):n={},n}function f(t){var e,n,r=o(),i=$.get(r)||"",u=i.split(I),a=u.length,c=t.cid||void 0,f=t.vid||void 0;if(~i.indexOf(c)||~i.indexOf(f)){for(e=a-1;e>=0;e--)if(n=u[e].split(N),~n[0].indexOf(c)||~n[0].indexOf(f)){u.splice(e,1),u.unshift(new k(t).toString());break}}else a>=_&&u.splice(a-1,1),u.unshift(new k(t).toString());$.set(r,u.join(I))}function s(){return+new Date-P>q}function p(t,e){function n(t,e){t?J=!1:(J=!1,l(i))}f(t);var r=o();if((e||s())&&!J&&r!==S){P=+new Date,J=!0;var i=d();if(i.length>0)if(i.length>1)E.batchReport({list:i.join(I)},n);else{var u=i[0].split("+");E.reportOne({keyid:u[0],time:u[1],date:u[2],hd:u[3],typeid:u[4]},n)}}return!0}function l(t){$.remove(S);var e,n,r,i=+new Date,u=o(),a=$.get(u)||"";x.forEach(t,function(t){t=t.split("+")[0],~(e=a.indexOf(t))&&(n=a.indexOf(I,e),r=a.slice(e,n),r=r.split(N),r[8]=i,a=a.slice(0,e)+r.join(N)+a.slice(n))}),$.set(u,a)}function d(){function t(t){return[t[0],t[3],parseInt(t[2]/1e3),t[9],t[6]].join("+")}var e,n=[],r=o();return e=$.get(S)||"",r!=S&&(e+=I+($.get(r)||"")),e=e.split(I),x.forEach(e,function(e){e=e.split(N),e[2]>=e[8]&&n.push(t(e))}),n}function h(t){var e=[],n=[],r=!1,i=o(),u=$.get(i)||"";u=a(u,"_");var c,f,s;x.forEach(u,function(e){r=!1,x.some(t,function(t){if(s=e.keyid.split(R),f=s[0]||void 0,c=s[1]||void 0,~t.keyid.indexOf(f)||~t.keyid.indexOf(c))return parseInt(t.date/1e3)<parseInt(e.date/1e3)&&(t.keyid===e.keyid?(t.time=e.time||t.time,t.episode=e.episode||t.episode,t.hd=e.hd||t.hd,t.date=e.date,t.serverDate=e.serverDate):x.extend(t,e)),r=!0,!0}),r||n.push(e)}),t=t.concat(n),t.sort(T.by("date")),t.splice(_,t.length-_),x.forEach(t,function(t){e.push(t.toString())}),$.set(i,e.join(I))}function v(t,e){function n(n,r){if(n)e(n);else{var o,u=m(r);o=t.cid||t.vid?u[0]||{}:y(u||[]),e(null,o),j&&setTimeout(function(){h(m(r,!0)),s&&(a[i]=+new Date,$.set(D,JSON.stringify(a)))})}}var r=u(t.cid,t.vid),i=o();if(i===S)return void e("用户没有登陆");var a=g(),f={},s=!0;if(r.length>2&&(s=!1),"array"==x.type(t)&&(s=!1,r=t.join(I)),t.cur&&(f.cur=t.cur,s=!1),t.pn&&(f.pn=t.pn,s=!1),s&&!function(){if(!j)return!1;var t=parseInt(a[i])||0;return+new Date-t>C&&(delete a[i],$.set(D,JSON.stringify(a)),!0)}())return void e(null,c());!function(){O.getHistory(r,n,f)}()}function g(){if(!j)return{};var t=$.get(D);return t=t||"{}",t=JSON.parse(t)}function y(t){for(var e={},n=0,r=t.length;n<r;n++)e[t[n].keyid]=t[n];return e}function m(t,e){var n=[];return e?x.forEach(t,function(t){n.push(new k(t))}):x.forEach(t,function(t){t.dur=t.tl,t.date=1e3*t.date,t.serverDate=t.date+1e3,n.push(new k(t))}),n}function w(t,e){return e=e||11,new RegExp("^[a-zA-Z0-9]{"+e+"}$").test(t)}var x=n(1),b=n(2),k=n(3),E=n(4),O=n(8),T=n(9),j="object"==typeof window.localStorage&&!!localStorage.getItem,S="ten_video_history",D="ten_video_history_uin",I="|",N=",",R="_",_=100,q=12e4,P=q,C=36e5,J=!1,$={get:r,set:r,remove:r};j&&x.extend($,{get:function(t){return localStorage.getItem(t)},set:function(t,e){return localStorage.setItem(t,e)},remove:function(t){return localStorage.removeItem(t)}});var A={get:function(t,e){if("function"==typeof t&&(e=t,t={}),"array"===x.type(t)&&t.length>10)throw new Error("一次最多传入10个");v(t,e)},getSync:function(t){return j?(t=t||{},c(t.cid,t.vid)):{}},set:function(t,e){return!!j&&("object"===x.type(t)&&(t.time=parseInt(t.time),!(!t.vid||isNaN(t.time))&&(!(!w(t.vid,11)&&!w(t.cid,15))&&(t.hd=t.hd&&parseInt(t.hd)||0,t.typeid=t.typeid&&t.typeid.toString()||"",p(t,e)))))}};A.get(r),t.exports=A},function(t,e){"use strict";function n(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e)}var r={escape:function(t){return t?String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;"):""},type:function(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=/\[object (\w+)\]/.exec(Object.prototype.toString.call(t));return e?e[1].toLowerCase():""},keys:function(t){var e=[];return t?Object.keys?Object.keys(t):(this.objEach(t,function(t){e.push(t)}),e):e},bind:function(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}},extend:function(t){if("object"!=this.type(t)&&"function"!=this.type(t))return t;for(var e,r,i=1,o=arguments.length;i<o;i++){e=arguments[i];for(r in e)n(e,r)&&(t[r]=e[r])}return t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/gm,"")},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);var n=-1;return r.some(t,function(t,r){if(t===e)return n=r,!0}),n},forEach:function(t,e){if(t.forEach)return t.forEach(e);for(var n=t.length,r=0;r<n;r++)e(t[r],r);return t},some:function(t,e){if(t.some)return t.some(e);for(var n=t.length,r=!1,i=0;i<n;i++)if(e(t[i],i)){r=!0;break}return r},map:function(t,e){if(t.map)return t.map(e);for(var n=t.length,r=[],i=0;i<n;i++)r.push(e(t[i],i));return r},objEach:function(t,e){if(t)for(var r in t)if(n(t,r)&&!1===e(r,t[r]))break},reduce:function(t,e){if("function"!=r.type(e))throw new TypeError("Array.prototype.reduce callback must be a function");var n=t.length;if(0===n&&2===arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,o=0;if(arguments.length>=3)i=arguments[2];else for(;;){if(o in t){i=t[o++];break}if(++o>=n)throw new TypeError("reduceRight of empty array with no initial value")}for(;o<n;o++)i=e(i,t[o],o,t);return i},filter:function(t,e,n){if(t.filter)return t.filter(e);for(var r=t.length,i=[],o=0;o<r;o++){var u=t[o];e.call(n,u,o,t)&&i.push(u)}return i},nextTick:function(){var t=this;return function(){setTimeout.apply(t,arguments)}}(),lock:function(t){var e;return function(){if(!e){e=!0;var n=[].slice.call(arguments,0);n.unshift(function(){e=!1}),t.apply(this,n)}}},queue:function(t,e){function n(){var t=i.shift();if(!t)return void(o=e);o--;var u=t[0],a=t[1],c=t[2];c.unshift(function(){o++,n.apply(this,arguments)}),r.nextTick(function(){return u.apply(a,c)})}e=e||1;var i=[],o=e;return function(){if(i.push([t,this,[].slice.call(arguments,0)]),o)return n()}},delegator:function(t){var e,n=[];return function(i){if(e)return n.push(i);e=!0,t.call(this,function(){e=!1;var t=this,o=arguments;i&&i.apply(t,o),r.forEach(n,function(e){e&&e.apply(t,o)})})}},once:function(t){var e,n=arguments;return function(){if(!e&&t)return e=!0,t.apply(n.length>=2?n[1]:null,arguments)}},verCompare:function(t,e){if(t===e)return 0;t=t.split("."),e=e.split(".");for(var n=t.length>=e.length?t.length:e.length,r=0;n--;){var i=Number(t[r]||0),o=Number(e[r++]||0);if(o>i)return 1;if(o<i)return-1}return 0}};t.exports=r},function(t,e){"use strict";t.exports={set:function(t,e,n,r,i){if(i){var o=new Date,u=new Date;u.setTime(o.getTime()+36e5*i)}return document.cookie=t+"="+e+"; "+(i?"expires="+u.toGMTString()+"; ":"")+(r?"path="+r+"; ":"path=/; ")+(n?"domain="+n+";":"domain="+window.location.host+";"),!0},get:function(t,e){var n=new RegExp("(?:^|;+|\\s+)"+t+"=([^;]*)"),r=(e||document.cookie).match(n);return r?r[1]:""},del:function(t,e,n){var r=new Date;r.setTime(r.getTime()-1),document.cookie=t+"=; expires="+r.toGMTString()+";"+(n?"path="+n+"; ":"path=/; ")+(e?"domain="+e+";":"domain="+window.location.host+";")}}},function(t,e){function n(t){(t.title||t.vtit)&&(t.title=(t.title||"")+" "+(t.vtit||"")),this.title=t.title||t[1]||"",this.time=t.time||t[3]||0,this.dur=t.dur||t.tl||t[4]||0,this.episode=t.episode||t[7]||0,this.ispay=t.ispay||t[5]||"",this.keyid=t[0]||t.keyid||(t.cid||"")+"_"+(t.vid||""),this.typeid=t.typeid||t.ctypeid||t[6],this.date=t.date||t[2]||(new Date).getTime(),this.serverDate=t.serverDate||t[8]||0,this.hd=t.hd||t[9]||0}n.prototype.toString=function(){return[this.keyid,this.title,this.date,this.time,this.dur,this.ispay,this.typeid,this.episode,this.serverDate,this.hd].join(",")},t.exports=n},function(t,e,n){function r(t,e){t=u.extend(t,{plat:2,pver:3,rf:"v",t:o.rParamT.ONEREPORT}),a(c,t,function(t,n){t?e("上报失败"):e(null,n)})}function i(t,e){t=u.extend({pn:1,list:"",rf:"v"},t,{t:o.rParamT.BATCHREPORT,cur:1,simp:1,plat:2,pver:3}),a(c,t,function(t,n){t?e("上报失败"):e(null,n)})}var o=n(5),u=n(1),a=n(6),c=o.api.myviewreport;t.exports={reportOne:r,batchReport:i}},function(t,e){t.exports={api:{specifyview:"//node.video.qq.com/x/api/specify_history",myviewreport:"//like.video.qq.com/fcgi-bin/myviewreport?otype=json",batchview:"//node.video.qq.com/x/api/batch_history"},rParamT:{ONEREPORT:3,BATCHREPORT:4}}},function(t,e,n){"use strict";function r(){}function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function u(t,e,n){var u=arguments;return a(function(a,v){var g;if("object"==typeof e&&(g=e,e=n,n=u[3]),g=g||{},n=n||{},"function"!=typeof(e=e||r))throw Error("illegal jsonp callback function:",e);var y=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:document.body,m=document.createElement("script");m.charset="UTF-8";var w=[n.ns||s,l++,i()].join("_"),x=!0,b="_t",k=n.time;n.callbackid&&(w=n.callbackid),!1===k?x=!1:k&&(b=k),g[n.pn||n.callbackName||p]=w,x&&(g[b]=+new Date);var E=function(t){o(m),e(null,t),a&&a(t)},O=function(t){o(m),e(t||"error"),window[w]=E=O=r,v&&v(t||error)},T=window[w];window[w]=function(t){window[w]=r;try{T&&T(t)}finally{E(t),E=O=r}},m.onerror=m.onabort=function(t){O(t?t.type:"error")},c.forEach(h,function(e){"function"==c.type(e)&&(t=e(t,g)||t)}),m.src=f.queryJoin(t,g),y.appendChild(m),setTimeout(function(){O("timeout")},n.timeout||d)})}function a(t){if(window.Promise)return new Promise(t);t(r,r)}var c=n(1),f=n(7),s="_jsonp",p="callback",l=0,d=2e4,h=[];u.timeout=function(t){d=t},u.ns=function(t){s=t},u.pn=function(t){p=t},u.before=function(t){h.push(t)},t.exports=u},function(t,e,n){"use strict";var r=n(1),i={queryParse:function(t,e){if(!t)return{};e=e||"&";var n=t.replace(/^\?/,""),i={},o=n?n.split(e):null;return o&&o.length>0&&r.forEach(o,function(t){t=t.split("=");var e=t.splice(0,1),n=t.join("=");i[e]=n}),i},queryJoin:function(t,e){var n=i.queryStringify(e);if(!n)return t;var r;return r=/[\?&]$/.test(t)?"":~t.indexOf("?")?"&":"?",t+r+n},queryStringify:function(t,e){return t?r.map(r.keys(t),function(e){return e+"="+encodeURIComponent(t[e])}).join(e||"&"):""}};t.exports=i},function(t,e,n){function r(t,e,n){var r,c;t.length>2?(r={list:t},c=i.api.specifyview):(r={pn:0,cur:0},c=i.api.batchview,n.pn&&n.pn>a&&(n.pn=a),r=u.extend(r,n)),o(c,r,function(n,r){n?e(n):r&&r.result&&r.result.code<0?e("请求失败"):(r=r&&r.list||[],r.length>0?e(null,r):e("不存在"+t+"的历史记录"))})}var i=n(5),o=n(6),u=n(1),a=10;t.exports={getHistory:r}},function(t,e){t.exports={by:function(t){return function(e,n){return(parseInt(e[t])||0)<(parseInt(n[t])||0)?1:-1}}}}]);